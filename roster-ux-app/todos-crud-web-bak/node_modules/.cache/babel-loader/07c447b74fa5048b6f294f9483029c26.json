{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Contract = void 0;\n\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n\nconst depd_1 = __importDefault(require(\"depd\"));\n\nconst providers_1 = require(\"./providers\");\n\nconst errors_1 = require(\"./utils/errors\"); // Makes `function.name` return given name\n\n\nfunction nameFunction(name, body) {\n  return {\n    [name](...args) {\n      return body(...args);\n    }\n\n  }[name];\n}\n\nconst isUint8Array = x => x && x.byteLength !== undefined && x.byteLength === x.length;\n\nconst isObject = x => Object.prototype.toString.call(x) === '[object Object]';\n/**\n * Defines a smart contract on NEAR including the change (mutable) and view (non-mutable) methods\n *\n * @example {@link https://docs.near.org/docs/develop/front-end/naj-quick-reference#contract}\n * @example\n * ```js\n * import { Contract } from 'near-api-js';\n *\n * async function contractExample() {\n *   const methodOptions = {\n *     viewMethods: ['getMessageByAccountId'],\n *     changeMethods: ['addMessage']\n *   };\n *   const contract = new Contract(\n *     wallet.account(),\n *     'contract-id.testnet',\n *     methodOptions\n *   );\n *\n *   // use a contract view method\n *   const messages = await contract.getMessages({\n *     accountId: 'example-account.testnet'\n *   });\n *\n *   // use a contract change method\n *   await contract.addMessage({\n *      meta: 'some info',\n *      callbackUrl: 'https://example.com/callback',\n *      args: { text: 'my message' },\n *      amount: 1\n *   })\n * }\n * ```\n */\n\n\nclass Contract {\n  /**\n   * @param account NEAR account to sign change method transactions\n   * @param contractId NEAR account id where the contract is deployed\n   * @param options NEAR smart contract methods that your application will use. These will be available as `contract.methodName`\n   */\n  constructor(account, contractId, options) {\n    this.account = account;\n    this.contractId = contractId;\n    const {\n      viewMethods = [],\n      changeMethods = []\n    } = options;\n    viewMethods.forEach(methodName => {\n      Object.defineProperty(this, methodName, {\n        writable: false,\n        enumerable: true,\n        value: nameFunction(methodName, async (args = {}, options = {}, ...ignored) => {\n          if (ignored.length || !(isObject(args) || isUint8Array(args)) || !isObject(options)) {\n            throw new errors_1.PositionalArgsError();\n          }\n\n          return this.account.viewFunction(this.contractId, methodName, args, options);\n        })\n      });\n    });\n    changeMethods.forEach(methodName => {\n      Object.defineProperty(this, methodName, {\n        writable: false,\n        enumerable: true,\n        value: nameFunction(methodName, async (...args) => {\n          if (args.length && (args.length > 3 || !(isObject(args[0]) || isUint8Array(args[0])))) {\n            throw new errors_1.PositionalArgsError();\n          }\n\n          if (args.length > 1 || !(args[0] && args[0].args)) {\n            const deprecate = depd_1.default('contract.methodName(args, gas, amount)');\n            deprecate('use `contract.methodName({ args, gas?, amount?, callbackUrl?, meta? })` instead');\n            return this._changeMethod({\n              methodName,\n              args: args[0],\n              gas: args[1],\n              amount: args[2]\n            });\n          }\n\n          return this._changeMethod({\n            methodName,\n            ...args[0]\n          });\n        })\n      });\n    });\n  }\n\n  async _changeMethod({\n    args,\n    methodName,\n    gas,\n    amount,\n    meta,\n    callbackUrl\n  }) {\n    validateBNLike({\n      gas,\n      amount\n    });\n    const rawResult = await this.account.functionCall({\n      contractId: this.contractId,\n      methodName,\n      args,\n      gas,\n      attachedDeposit: amount,\n      walletMeta: meta,\n      walletCallbackUrl: callbackUrl\n    });\n    return providers_1.getTransactionLastResult(rawResult);\n  }\n\n}\n\nexports.Contract = Contract;\n/**\n * Validation on arguments being a big number from bn.js\n * Throws if an argument is not in BN format or otherwise invalid\n * @param argMap\n */\n\nfunction validateBNLike(argMap) {\n  const bnLike = 'number, decimal string or BN';\n\n  for (const argName of Object.keys(argMap)) {\n    const argValue = argMap[argName];\n\n    if (argValue && !bn_js_1.default.isBN(argValue) && isNaN(argValue)) {\n      throw new errors_1.ArgumentTypeError(argName, bnLike, argValue);\n    }\n  }\n}","map":{"version":3,"sources":["/home/jjsullivan/near-roster-ux-project/roster-ux-app/todos-crud-web-bak/node_modules/near-api-js/lib/contract.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","Contract","bn_js_1","require","depd_1","providers_1","errors_1","nameFunction","name","body","args","isUint8Array","x","byteLength","undefined","length","isObject","prototype","toString","call","constructor","account","contractId","options","viewMethods","changeMethods","forEach","methodName","writable","enumerable","ignored","PositionalArgsError","viewFunction","deprecate","default","_changeMethod","gas","amount","meta","callbackUrl","validateBNLike","rawResult","functionCall","attachedDeposit","walletMeta","walletCallbackUrl","getTransactionLastResult","argMap","bnLike","argName","keys","argValue","isBN","isNaN","ArgumentTypeError"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Contract = void 0;\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\nconst depd_1 = __importDefault(require(\"depd\"));\nconst providers_1 = require(\"./providers\");\nconst errors_1 = require(\"./utils/errors\");\n// Makes `function.name` return given name\nfunction nameFunction(name, body) {\n    return {\n        [name](...args) {\n            return body(...args);\n        }\n    }[name];\n}\nconst isUint8Array = (x) => x && x.byteLength !== undefined && x.byteLength === x.length;\nconst isObject = (x) => Object.prototype.toString.call(x) === '[object Object]';\n/**\n * Defines a smart contract on NEAR including the change (mutable) and view (non-mutable) methods\n *\n * @example {@link https://docs.near.org/docs/develop/front-end/naj-quick-reference#contract}\n * @example\n * ```js\n * import { Contract } from 'near-api-js';\n *\n * async function contractExample() {\n *   const methodOptions = {\n *     viewMethods: ['getMessageByAccountId'],\n *     changeMethods: ['addMessage']\n *   };\n *   const contract = new Contract(\n *     wallet.account(),\n *     'contract-id.testnet',\n *     methodOptions\n *   );\n *\n *   // use a contract view method\n *   const messages = await contract.getMessages({\n *     accountId: 'example-account.testnet'\n *   });\n *\n *   // use a contract change method\n *   await contract.addMessage({\n *      meta: 'some info',\n *      callbackUrl: 'https://example.com/callback',\n *      args: { text: 'my message' },\n *      amount: 1\n *   })\n * }\n * ```\n */\nclass Contract {\n    /**\n     * @param account NEAR account to sign change method transactions\n     * @param contractId NEAR account id where the contract is deployed\n     * @param options NEAR smart contract methods that your application will use. These will be available as `contract.methodName`\n     */\n    constructor(account, contractId, options) {\n        this.account = account;\n        this.contractId = contractId;\n        const { viewMethods = [], changeMethods = [] } = options;\n        viewMethods.forEach((methodName) => {\n            Object.defineProperty(this, methodName, {\n                writable: false,\n                enumerable: true,\n                value: nameFunction(methodName, async (args = {}, options = {}, ...ignored) => {\n                    if (ignored.length || !(isObject(args) || isUint8Array(args)) || !isObject(options)) {\n                        throw new errors_1.PositionalArgsError();\n                    }\n                    return this.account.viewFunction(this.contractId, methodName, args, options);\n                })\n            });\n        });\n        changeMethods.forEach((methodName) => {\n            Object.defineProperty(this, methodName, {\n                writable: false,\n                enumerable: true,\n                value: nameFunction(methodName, async (...args) => {\n                    if (args.length && (args.length > 3 || !(isObject(args[0]) || isUint8Array(args[0])))) {\n                        throw new errors_1.PositionalArgsError();\n                    }\n                    if (args.length > 1 || !(args[0] && args[0].args)) {\n                        const deprecate = depd_1.default('contract.methodName(args, gas, amount)');\n                        deprecate('use `contract.methodName({ args, gas?, amount?, callbackUrl?, meta? })` instead');\n                        return this._changeMethod({\n                            methodName,\n                            args: args[0],\n                            gas: args[1],\n                            amount: args[2]\n                        });\n                    }\n                    return this._changeMethod({ methodName, ...args[0] });\n                })\n            });\n        });\n    }\n    async _changeMethod({ args, methodName, gas, amount, meta, callbackUrl }) {\n        validateBNLike({ gas, amount });\n        const rawResult = await this.account.functionCall({\n            contractId: this.contractId,\n            methodName,\n            args,\n            gas,\n            attachedDeposit: amount,\n            walletMeta: meta,\n            walletCallbackUrl: callbackUrl\n        });\n        return providers_1.getTransactionLastResult(rawResult);\n    }\n}\nexports.Contract = Contract;\n/**\n * Validation on arguments being a big number from bn.js\n * Throws if an argument is not in BN format or otherwise invalid\n * @param argMap\n */\nfunction validateBNLike(argMap) {\n    const bnLike = 'number, decimal string or BN';\n    for (const argName of Object.keys(argMap)) {\n        const argValue = argMap[argName];\n        if (argValue && !bn_js_1.default.isBN(argValue) && isNaN(argValue)) {\n            throw new errors_1.ArgumentTypeError(argName, bnLike, argValue);\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"script"}